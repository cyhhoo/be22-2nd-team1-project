@host = http://localhost:8080
@contentType = application/json
@studentId = 20
@email = test3@example.com
@password = pass3
@authCode = 05-01-01
@name = Tester3
@birthDate = 2005-01-01
@role = STUDENT
# registerUser() uses birthDate.substring(2), so 2005-01-01 -> 05-01-01
@accessToken =
@refreshToken =
@teacherEmail = teacher@schoolmate.test
@teacherPassword = Password123!
@teacherUserId = 10
@teacherAccessToken =
@adminEmail = admin@schoolmate.test
@adminPassword = Password123!
@adminUserId = 1
@adminAccessToken =

### 0-1. 회원 가입
POST http://localhost:8080/api/auth/register
Content-Type: {{contentType}}

{
  "email": "{{email}}",
  "password": "{{password}}",
  "name": "{{name}}",
  "birthDate": "{{birthDate}}",
  "role": "{{role}}"
}

### 계정 활성화
POST {{baseUrl}}/api/auth/activate
Content-Type: application/json

{
  "email": "{{email}}",
  "name": "{{name}}",
  "birthDate": "{{birthDate}}",
  "authCode": "{{authCode}}",
  "newPassword": "{{password}}"
}

### 로그인
POST http://{{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### 교사 로그인 (샘플 데이터)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### 관리자 로그인 (샘플 데이터)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{adminEmail}}",
  "password": "{{adminPassword}}"
}

### 토큰 재발급 (RefreshToken 쿠키 필요)
POST {{baseUrl}}/api/auth/reissue
Cookie: RefreshToken={{refreshToken}}

### 비밀번호 변경 (로그인 후 accessToken 필요)
POST {{baseUrl}}/api/users/mypage/password
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "currentPassword": "{{password}}",
  "newPassword": "NewPassword123!"
}

### 출결 자동 생성 (인증 필요)
POST {{baseUrl}}/api/v1/attendance
Authorization: Bearer {{teacherAccessToken}}
Content-Type: application/json

{
  "courseId": {{courseId}},
  "classDate": "{{classDate}}",
  "period": {{period}},
  "userId": {{teacherUserId}}
}

### 출결 저장 (임시로 인증 없이 허용됨)
PATCH {{baseUrl}}/api/v1/attendance
Content-Type: application/json

{
  "courseId": {{courseId}},
  "classDate": "{{classDate}}",
  "period": {{period}},
  "userId": {{teacherUserId}},
  "items": [
    { "enrollmentId": {{enrollmentId1}}, "attendanceCodeId": {{lateCodeId}}, "reason": "지각" },
    { "enrollmentId": {{enrollmentId2}}, "attendanceCodeId": {{presentCodeId}}, "reason": null }
  ]
}

### 출결 코드 목록 조회
GET {{baseUrl}}/api/v1/attendance/codes?activeOnly=true

### 출결 확정 (인증 필요)
POST {{baseUrl}}/api/v1/attendance/confirmations
Authorization: Bearer {{teacherAccessToken}}
Content-Type: application/json

{
  "courseId": {{courseId}},
  "classDate": "{{classDate}}",
  "period": {{period}},
  "userId": {{teacherUserId}}
}

### 출결 마감 (인증 필요)
POST {{baseUrl}}/api/v1/attendance/closures
Authorization: Bearer {{adminAccessToken}}
Content-Type: application/json

{
  "academicYearId": {{academicYearId}},
  "scopeType": "MONTH",
  "scopeValue": "{{scopeValue}}",
  "courseId": {{courseId}},
  "userId": {{adminUserId}}
}

### 출결 정정 요청 (인증 필요, 확정 후 테스트 권장)
POST {{baseUrl}}/api/v1/attendance/corrections
Authorization: Bearer {{teacherAccessToken}}
Content-Type: application/json

{
  "attendanceId": {{attendanceId}},
  "requestedAttendanceCodeId": {{presentCodeId}},
  "requestReason": "지각이 아니라 출석",
  "requestedBy": {{teacherUserId}}
}

### 출결 정정 승인 (인증 필요)
PATCH {{baseUrl}}/api/v1/attendance/corrections/{{correctionRequestId}}
Authorization: Bearer {{adminAccessToken}}
Content-Type: application/json

{
  "approved": true,
  "adminId": {{adminUserId}}
}

### 출결 조회 (인증 필요)
GET {{baseUrl}}/api/v1/attendance?fromDate={{classDate}}&toDate={{classDate}}&courseId={{courseId}}&period={{period}}
Authorization: Bearer {{teacherAccessToken}}

### 출결 단건 조회 (인증 필요)
GET {{baseUrl}}/api/v1/attendance/{{attendanceId}}
Authorization: Bearer {{teacherAccessToken}}
